# ============================================================
# TMUX Configuration - Enhanced Setup 
# ============================================================

# Terminal and display settings
# ------------------------------------------------------------
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc" # True color support
set -g focus-events on

# Prefix Key Configuration
# ------------------------------------------------------------
set -g prefix C-a
unbind C-b
bind-key C-a send-prefix

# Window and Pane Management
# ------------------------------------------------------------
# Better pane splitting
unbind %
bind | split-window -h -c "#{pane_current_path}" # Split horizontally in path
unbind '"'
bind - split-window -v -c "#{pane_current_path}" # Split vertically in path

# New window in current path
bind c new-window -c "#{pane_current_path}"

# Configuration reload
unbind r
bind r source-file ~/.config/tmux/tmux.conf display-message "Config reloaded!"

# vim-like pane switching
bind -r k select-pane -U 
bind -r j select-pane -D 
bind -r h select-pane -L 
bind -r l select-pane -R 

# resizing panes 
bind -r C-k resize-pane -U 5
bind -r C-j resize-pane -D 5
bind -r C-h resize-pane -L 5
bind -r C-l resize-pane -R 5

# Maximize/minimize pane
bind -r m resize-pane -Z

# Window Configuration
bind -r C-h previous-window
bind -r C-l next-window

# Quick window switching 
bind -n M-1 select-window -t 1 
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3 
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5

# Session Management 
# ---------------------------------------------------------------------------------------------
# Quick session switching 
bind -r ) switch-client -p
bind -r ) switch-client -n

# Session tree view
bind -r s choose-tree -sZ -O name

# Mouse and Input Settings 
# -----------------------------------------------------------------------------------------------
set -g mouse on
set-window-option -g mode-keys vi
set -g set-clipboard on

# Copy Mode Enhancements
# ----------------------------------------------------------------------------------------------
# Enter copy mode with escape 
bind Escape copy-mode

# Vi-style copy mode bindings 
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'C-v' send -X rectangle-toggle
bind-key -T copy-mode-vi 'y' send -X copy-selection-and-cancel
bind-key -T copy-mode-vi 'Y' send -X copy-line

# Mouse drag copy
unbind -T copy-mode-vi MouseDragEnd1Pane
bind-key -T copy-mode-vi MouseDragEnd1Pane send -X copy-selection-and-cancel

# MacOs clipboard intergration
# bind C-c run "tmux save-buffer - | pbcopy"
# bind C-v run "pbpaste | tmux load-buffer - && tmux paste-buffer"

# Performance and Behavior Settings
# -----------------------------------------------------------------------------
set -g history-limit 10000                # Increase scrollback buffer
set -g display-time 2000                  # Display messages for 2 seconds
set -g display-panes-time 2000            # Display pane numbers for 2 seconds
set -sg escape-time 0                     # No delay for escape key press
set -g repeat-time 600                    # Increase repeat timeout
set -g base-index 1                       # Start windows at 1, not 0
setw -g pane-base-index 1                 # Start panes at 1, not 0
set -g renumber-windows on                # Renumber windows when one is closed
set -g allow-rename off                   # Don't rename windows automatically

# Status Bar Configuration
# -----------------------------------------------------------------------------
set -g status on
set -g status-interval 5
set -g status-position bottom
set -g status-justify left
set -g status-left-length 50
set -g status-right-length 100

# Status bar colors and styling
set -g status-style bg=colour234,fg=colour137
set -g status-left '#[fg=colour233,bg=colour245,bold] #S #[fg=colour245,bg=colour234,nobold]'
set -g status-right '#[fg=colour245]#[fg=colour233,bg=colour245] %Y-%m-%d %H:%M #[fg=colour166,bg=colour245]#[fg=colour233,bg=colour166,bold] #h'

# Window status styling
set -g window-status-format '#[fg=colour244,bg=colour234] #I:#W#F '
set -g window-status-current-format '#[fg=colour234,bg=colour166]#[fg=colour233,bg=colour166,bold] #I:#W#F #[fg=colour166,bg=colour234,nobold]'

# Pane border colors
set -g pane-border-style fg=colour238
set -g pane-active-border-style fg=colour166

# Message styling
set -g message-style bg=colour166,fg=colour233,bold
set -g message-command-style bg=colour233,fg=colour166

# Modern Features
# -----------------------------------------------------------------------------
# Popup window for quick commands
bind-key p display-popup -E "tmux new-session -A -s popup"

# Quick edit config
bind-key e new-window -n "tmux-config" "sh -c '\${EDITOR:-vim} ~/.config/tmux/tmux.conf && tmux source ~/.config/tmux/tmux.conf && tmux display \"Config reloaded\"'"

# Kill session/server shortcuts
bind-key X confirm-before -p "Kill session #S? (y/n)" kill-session
bind-key C-x confirm-before -p "Kill tmux server? (y/n)" kill-server

# Window/Pane Information
bind-key i display-message "Window: #I, Pane: #P, Session: #S"
# =============================================================================
# PLUGIN CONFIGURATION
# =============================================================================

# TPM Plugin Manager
set -g @plugin 'tmux-plugins/tpm'

# Core Plugins
set -g @plugin 'jimeh/tmux-themepack'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-yank'

# Additional Productivity Plugins
set -g @plugin 'tmux-plugins/tmux-sensible'      # Sensible defaults
set -g @plugin 'tmux-plugins/tmux-pain-control'  # Better pane control
set -g @plugin 'tmux-plugins/tmux-sessionist'    # Session management
set -g @plugin 'tmux-plugins/tmux-open'          # Open URLs/files from tmux

# Plugin Settings
# -----------------------------------------------------------------------------

# Theme Configuration
set -g @themepack 'powerline/default/cyan'

# Resurrect Settings
set -g @resurrect-capture-pane-contents 'on'
set -g @resurrect-strategy-vim 'session'
set -g @resurrect-strategy-nvim 'session'
set -g @resurrect-processes 'ssh psql mysql sqlite3'

# Continuum Settings
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'
set -g @continuum-boot 'on'
set -g @continuum-boot-options 'iterm,fullscreen'

# Yank Settings
set -g @yank_selection_mouse 'clipboard'
set -g @yank_action 'copy-pipe-and-cancel'

# Pain Control Settings (enhanced pane management)
set -g @pane_resize "5"

# Open Plugin Settings
set -g @open-S 'https://www.google.com/search?q='

# In your ~/.tmux.conf

# Add the colors from the pallete. Check the themes/ directory for all options.

# Some basic mocha colors.
set -g @ctp_bg "#24273a"
set -g @ctp_surface_1 "#494d64"
set -g @ctp_fg "#cad3f5"
set -g @ctp_mauve "#c6a0f6"
set -g @ctp_crust "#181926"

# status line
set -gF status-style "bg=#{@ctp_bg},fg=#{@ctp_fg}"

# windows
set -gF window-status-format "#[bg=#{@ctp_surface_1},fg=#{@ctp_fg}] ##I ##T "
set -gF window-status-current-format "#[bg=#{@ctp_mauve},fg=#{@ctp_crust}] ##I ##T "

# =============================================================================
# INITIALIZE PLUGIN MANAGER (Keep at bottom)
# =============================================================================
run '~/.config/tmux/plugins/tpm/tpm'
